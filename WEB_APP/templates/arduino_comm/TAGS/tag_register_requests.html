{% extends "arduino_comm/TAGS/base.html" %}

{% block title %}Tag Register Requests{% endblock %}

{% block content %}

<h2 class="mb-3">Tag Register Requests</h2>

<table class="table table-dark table-hover">
  <thead>
    <tr>
      <th>UID</th>
      <th>Device</th>
      <th>Notes</th>
      <th>Status</th>
      <th>Requested</th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    {% for req in requests %}
    <tr>
      <td>{{ req.tag_uid }}</td>

      <td>
        {{ req.device.name|default:"—" }}
      </td>

      <td>
        {{ req.notes|default:"—" }}
      </td>

      <td>
        {% if req.status == "approved" %}
          <span class="badge bg-success">Approved</span>
        {% elif req.status == "rejected" %}
          <span class="badge bg-danger">Rejected</span>
        {% else %}
          <span class="badge bg-info">Pending</span>
        {% endif %}
      </td>

      <td>{{ req.requested_at }}</td>

      <td>
        <a href="{% url 'arduino_comm:approve_tag_register_request' req.id %}"
           class="btn btn-sm btn-success">
          Approve
        </a>

        <a href="{% url 'arduino_comm:reject_tag_register_request' req.id %}"
           class="btn btn-sm btn-danger">
          Reject
        </a>

        <form method="post"
              action="{% url 'arduino_comm:delete_all_register_requests_for_tag' req.id %}"
              style="display:inline;">
          {% csrf_token %}
          <button type="submit"
                  class="btn btn-sm btn-secondary"
                  onclick="return confirm('Delete all register requests for this tag?');">
            Delete all
          </button>
        </form>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="6" class="text-center text-muted">
        No registration requests found.
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
